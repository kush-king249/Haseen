# حصين (Haseen) - نظام جدار حماية متقدم

## نظرة عامة

يهدف مشروع **حصين** إلى تطوير نظام جدار حماية قوي ومتقدم يتجاوز مجرد تصفية الحزم التقليدية. يعمل هذا النظام كحاجز دفاعي متعدد الطبقات، يجمع بين المراقبة الأساسية لحزم البيانات (Packet Filtering) وميزات أكثر تطورًا مثل فحص الحزم العميق (Deep Packet Inspection) ووحدة للكشف عن التسلل (IDS). تم تصميم النظام ليكون قابلًا للتوسع، مما يجعله مناسبًا للاستخدام في بيئات مختلفة، ويوفر واجهة رسومية جذابة وتفاعلية باللغة العربية لتسهيل الإدارة والمراقبة.

## الميزات الرئيسية

*   **تصفية الحزم المتقدمة**: السماح أو حظر الحزم بناءً على قواعد معقدة تشمل عناوين IP، المنافذ، والبروتوكولات.
*   **الكشف عن التسلل (IDS)**: مراقبة حركة المرور بحثًا عن أنماط هجمات معروفة أو سلوكيات مشبوهة.
*   **فحص الحزم العميق (DPI)**: تحليل حمولة الحزم للكشف عن التهديدات المضمنة مثل حقن SQL أو هجمات XSS.
*   **التحكم في التطبيقات**: القدرة على تحديد الحزم بناءً على التطبيق الذي أنشأها (ميزة مستقبلية).
*   **التسجيل والتحليل**: تسجيل جميع الأحداث الأمنية في قاعدة بيانات لتحليلها لاحقًا وإنشاء تقارير مفصلة.
*   **واجهة رسومية (GUI)**: واجهة ويب سهلة الاستخدام وتفاعلية باللغة العربية لإدارة النظام ومراقبة الأحداث والإحصائيات.
*   **واجهة سطر الأوامر (CLI)**: أدوات قوية للمطورين والمسؤولين لإدارة جدار الحماية من سطر الأوامر.
*   **قابلية التوسع**: بنية معيارية تسمح بإضافة ميزات ووحدات جديدة بسهولة.

## بنية النظام

يتكون نظام حصين من عدة وحدات رئيسية تعمل بتناغم لتوفير حماية شاملة:

1.  **محرك جدار الحماية (Firewall Engine)**:
    *   **`core.py`**: المنطق الأساسي لجدار الحماية، يدير بدء التشغيل والإيقاف، ومعالجة الحزم، ومراقبة النظام.
    *   **`packet_analyzer.py`**: مسؤول عن تحليل حزم البيانات، بما في ذلك فحص البروتوكولات، تحليل الحمولة، وكشف الأنماط المشبوهة.
    *   **`ids_module.py`**: وحدة الكشف عن التسلل، تقوم بفحص الحزم بناءً على قواعد توقيعية وسلوكية للكشف عن الهجمات.
    *   **`rules.py`**: محرك القواعد الذي يطبق القواعد المحددة مسبقًا أو المضافة من قبل المستخدم للسماح أو حظر الحزم.
    *   **`logger.py`**: نظام تسجيل الأحداث الذي يخزن جميع الأنشطة والتنبيهات في ملفات وقاعدة بيانات SQLite.

2.  **واجهة برمجة التطبيقات (API)**:
    *   **`api/app.py`**: خادم Flask الذي يوفر نقاط نهاية RESTful للتفاعل مع محرك جدار الحماية، مما يسمح للواجهة الرسومية (GUI) وواجهة سطر الأوامر (CLI) بالتحكم في النظام واسترداد البيانات.

3.  **الواجهة الرسومية (GUI)**:
    *   تطبيق ويب مبني باستخدام React، يوفر لوحة تحكم جذابة وتفاعلية لعرض الإحصائيات، التنبيهات، وإدارة القواعد.

4.  **واجهة سطر الأوامر (CLI)**:
    *   **`cli/main.py`**: أداة سطر أوامر مبنية باستخدام مكتبة Click، توفر أوامر لإدارة جدار الحماية، عرض السجلات، وإضافة/إزالة القواعد.

## المنهجية المستخدمة

تم تطوير مشروع حصين باتباع منهجية معيارية (Modular Approach) لضمان قابلية التوسع والصيانة. تم استخدام Python كلغة برمجة أساسية للواجهة الخلفية نظرًا لمرونتها ومكتباتها الغنية في مجال الشبكات والأمن. تم اختيار Flask لبناء واجهة برمجة التطبيقات لسهولته ومرونته، بينما تم استخدام React للواجهة الأمامية لتوفير تجربة مستخدم حديثة وتفاعلية.

### تقنيات ومكتبات رئيسية:

*   **Python**: اللغة الأساسية للواجهة الخلفية.
*   **Flask**: إطار عمل الويب لبناء واجهة برمجة التطبيقات (API).
*   **Scapy**: (مخطط للاستخدام الفعلي في المستقبل) لتحليل حزم البيانات بشكل عميق.
*   **netfilterqueue**: (مخطط للاستخدام الفعلي في المستقبل) للتفاعل مع قواعد iptables في Linux.
*   **PyYAML**: لإدارة ملفات التكوين والقواعد.
*   **SQLite**: قاعدة بيانات خفيفة الوزن لتخزين السجلات والأحداث.
*   **React**: مكتبة JavaScript لبناء الواجهة الرسومية التفاعلية.
*   **Tailwind CSS / shadcn/ui**: لتصميم واجهة مستخدم جذابة ومتجاوبة.
*   **Recharts**: لإنشاء الرسوم البيانية وعرض الإحصائيات في الواجهة الرسومية.
*   **Click**: مكتبة Python لبناء واجهة سطر الأوامر (CLI).
*   **Rich**: لتحسين إخراج سطر الأوامر وجعله أكثر جاذبية.

## تعليمات الإعداد والتشغيل

لإعداد وتشغيل مشروع حصين، اتبع الخطوات التالية:

### 1. المتطلبات الأساسية

تأكد من تثبيت المتطلبات التالية على نظامك:

*   Python 3.8+ (يفضل 3.11)
*   Node.js و npm/pnpm (لتشغيل الواجهة الرسومية)
*   `build-essential` (لبعض مكتبات Python التي تتطلب تجميع)
*   `libnetfilter-queue-dev` (لمكتبة netfilterqueue)
*   `libssl-dev` (لمكتبة yara-python)

يمكنك تثبيت حزم النظام المطلوبة على Ubuntu/Debian باستخدام الأوامر التالية:

```bash
sudo apt-get update
sudo apt-get install -y python3-dev python3.11-dev build-essential libnetfilter-queue-dev libssl-dev
```

### 2. استنساخ المستودع

```bash
git clone https://github.com/kush-king249/Haseen.git
cd Haseen
```

### 3. إعداد الواجهة الخلفية (Python Backend)

1.  **إنشاء بيئة افتراضية وتفعيلها:**
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    ```

2.  **تثبيت مكتبات Python المطلوبة:**
    ```bash
    pip install -r requirements.txt
    ```

3.  **تشغيل خادم API (في طرفية منفصلة):**
    ```bash
    cd api
    python3 app.py
    ```
    سيتم تشغيل الخادم على `http://localhost:5000`.

### 4. إعداد الواجهة الرسومية (React Frontend)

1.  **الانتقال إلى مجلد الواجهة الرسومية وتثبيت التبعيات:**
    ```bash
    cd gui/haseen-dashboard
    pnpm install
    ```

2.  **تشغيل خادم التطوير (في طرفية منفصلة):**
    ```bash
    pnpm run dev --host
    ```
    سيتم تشغيل الواجهة الرسومية على `http://localhost:5173` (أو منفذ مشابه).

### 5. استخدام واجهة سطر الأوامر (CLI)

يمكنك استخدام أداة CLI للتفاعل مع جدار الحماية. تأكد من أن الواجهة الخلفية (API) تعمل.

1.  **تفعيل البيئة الافتراضية (إذا لم تكن مفعلة):**
    ```bash
    source venv/bin/activate
    ```

2.  **أمثلة على أوامر CLI:**
    *   **بدء جدار الحماية (وضع المراقبة):**
        ```bash
        python3 cli/main.py start --mode=monitor
        ```
    *   **عرض حالة جدار الحماية:**
        ```bash
        python3 cli/main.py status
        ```
    *   **عرض السجلات الأخيرة:**
        ```bash
        python3 cli/main.py show-logs --limit 10
        ```
    *   **إضافة قاعدة حظر SSH من الخارج:**
        ```bash
        python3 cli/main.py add-rule --rule-id BLOCK_SSH_EXTERNAL_CLI --name 

        "حظر SSH من الخارج (CLI)" --action block --destination-port 22 --protocol TCP
        ```
    *   **عرض القواعد:**
        ```bash
        python3 cli/main.py show-rules
        ```

## المؤلف
صنع بفخر بواسطة:
Hassan Mohamed Hassan Ahmed

## ترخيص

هذا المشروع مرخص تحت رخصة MIT. انظر ملف `LICENSE` لمزيد من التفاصيل.

---
